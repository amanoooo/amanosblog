---
title: 重装机兵重构2-素材篇
date: 2025-02-08 08:49:46
tags:
    - Unity
    - Tiled
---


上一篇[重装机兵重构](/2025/01/15/重装机兵重构/)的后续



### Day12

1. 认识[Aseprite](https://www.aseprite.org/), 一个Animated Sprite Editor & Pixel Art Tool。这个工具可以快速把真实的画转成像素风
2. 认识[Tiled](https://www.mapeditor.org/), 比Unity自带的Palette 多了一个地形集，画地图更方便
3. 认识[SuperTiled2Unity](https://github.com/Seanba/SuperTiled2Unity) 可以把Tiled 的地图放入unity里面
4. 把多个Aseprite 合并成一个
```powershell
C:\Users\amanoooo\Desktop\Aseprite\aseprite --batch building-2.aseprite building3.aseprite building4.aseprite building5.aseprite building6.aseprite building7.aseprite building8.aseprite --sheet buildings.png


C:\Users\amanoooo\Desktop\Aseprite\aseprite --batch cliff1.aseprite cliff2.aseprite cliff3.aseprite garbge.aseprite grass.aseprite grass2.aseprite hedge.aseprite hedge2.aseprite hedge-left.aseprite shizijia.aseprite stone.aseprite tree1.aseprite water1.aseprite sand.aseprite 三个点.aseprite 宝箱1.aseprite 地板1.aseprite 地板2.aseprite 地板3.aseprite 工作台.aseprite 平台.aseprite 油桶1.aseprite 油桶2.aseprite --sheet envs.png```


### Day13

1. 在Tiled 上面增加对象层，增加对象， 然后unity 使用脚本实现把对象改成IsTrigger ,实现门碰撞逻辑， 通过SuperCustomProperties 来获取门的名称， 实现不同门的跳转. 脚本如下

**TiledMapColliderToTrigger** 放在空对象上
```csharp
using UnityEngine;
using SuperTiled2Unity;

public class TiledMapColliderToTrigger : MonoBehaviour
{
    void Start()
    {
        // 获取所有的 SuperObject 组件

        // 使用 FindObjectsByType 替代 FindObjectsOfType
        SuperObject[] superObjects = FindObjectsByType<SuperObject>(FindObjectsSortMode.None);


        foreach (SuperObject superObject in superObjects)
        {
            // 检查对象是否有碰撞器
            Collider2D collider = superObject.GetComponent<Collider2D>();
            if (collider != null)
            {
                // 动态添加 TriggerDoorNamePrinter 脚本
                superObject.gameObject.AddComponent<DoorHandler>();
            }
        }
    }
}
```
**DoorHandler**
```csharp
using UnityEngine;
using SuperTiled2Unity;

[RequireComponent(typeof(Collider2D))] // 确保对象有 Collider2D 组件
public class DoorHandler : MonoBehaviour
{
    private SuperCustomProperties customProperties;

    void Start()
    {
        // 获取 SuperCustomProperties 组件
        customProperties = GetComponent<SuperCustomProperties>();

        // 确保碰撞器是触发器
        Collider2D collider = GetComponent<Collider2D>();
        if (collider != null)
        {
            collider.isTrigger = true;
        }

        // 打印 doorName 的值
        PrintDoorName();
    }

    void OnTriggerEnter2D(Collider2D other)
    {
        // 当触发器被触发时打印 doorName
        PrintDoorName();
    }

    private void PrintDoorName()
    {
        if (customProperties != null)
        {
            // 检查是否有 doorName 属性
            if (customProperties.TryGetCustomProperty("doorName", out CustomProperty property))
            {
                Debug.Log($"Door Name: {property.m_Value}", this);
            }
            else
            {
                Debug.LogWarning("No doorName property found on this object.", this);
            }
        }
        else
        {
            Debug.LogWarning("No SuperCustomProperties component found on this object.", this);
        }
    }
}
```
